name: cloud-resources\ci

on:
  workflow_dispatch:
  push:
    branches: main
    paths: 
      - .github/workflows/cloud-resources-ci.yml
      - src/cloud-resources/**
      
defaults:
  run:
    working-directory: src/cloud-resources

jobs:
  build:
    name: Build
    runs-on:
      group: Helix
      labels: ubuntu-latest-16
    timeout-minutes: 15

    steps:

    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: 9.*

    - name: Cache NuGet packages
      id: nuget-packages
      uses: actions/cache@v4
      with:
        path: ~/.nuget/packages
        key: cloud-resources-nuget-${{ hashFiles('src/cloud-resources/**/*.csproj') }}
        restore-keys: cloud-resources-nuget-
        
    - name: Build reason
      run: echo ${{github.ref}} and ${{github.event_name}}

    - name: Build and test
      run: dotnet build -c Release CloudResources.slnf